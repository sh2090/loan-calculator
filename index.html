<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartTool Hub | Ultimate Finance & PDF Editor</title>
    <meta name="description" content="Free Universal Loan Calculator, Image Compressor, and PDF Editor/Merger.">
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root { --primary: #0f172a; --accent: #2563eb; --success: #10b981; --bg: #f8fafc; --sidebar: #ffffff; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; display: flex; color: #1e293b; min-height: 100vh; }

        /* Navigation */
        .sidebar { width: 280px; background: var(--sidebar); border-right: 1px solid #e2e8f0; padding: 30px 20px; position: fixed; height: 100vh; display: flex; flex-direction: column; z-index: 100; }
        .sidebar h2 { color: var(--accent); font-weight: 800; margin-bottom: 30px; letter-spacing: -1px; }
        .nav-btn { padding: 14px 18px; margin-bottom: 8px; border-radius: 12px; cursor: pointer; font-weight: 600; color: #64748b; transition: 0.3s; }
        .nav-btn:hover { background: #f1f5f9; color: var(--primary); }
        .nav-btn.active { background: var(--accent); color: white; box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.2); }

        /* Main Content */
        .main-content { margin-left: 280px; flex: 1; padding: 40px; max-width: 1000px; }
        .tool-section { display: none; animation: fadeIn 0.4s ease; }
        .tool-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card { background: white; padding: 35px; border-radius: 24px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .input-group { margin-bottom: 20px; }
        label { display: block; font-size: 0.85rem; font-weight: 700; margin-bottom: 8px; }
        input, select, textarea { width: 100%; padding: 14px; border: 2px solid #f1f5f9; border-radius: 12px; font-size: 1rem; box-sizing: border-box; outline: none; transition: 0.3s; }
        .hidden { display: none; }
        
        /* Ad Slots */
        .ad-slot { background: #f1f5f9; border: 1px dashed #cbd5e1; border-radius: 12px; margin: 20px 0; min-height: 90px; display: flex; align-items: center; justify-content: center; color: #94a3b8; font-size: 0.8rem; }

        /* Buttons */
        .action-btn { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        .action-btn:hover { background: #1d4ed8; }
        .btn-merge { background: var(--success); }

        /* Tabs */
        .goal-selector { display: flex; background: #f1f5f9; padding: 6px; border-radius: 14px; margin-bottom: 30px; }
        .g-btn { flex: 1; padding: 10px; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; color: #64748b; }
        .g-btn.active { background: white; color: var(--accent); }

        @media (max-width: 800px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; position: static; }
            .main-content { margin-left: 0; }
        }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>SmartTool Hub</h2>
    <div class="nav-btn active" onclick="showSection('loan-sec', this)">üí∞ Universal Loan</div>
    <div class="nav-btn" onclick="showSection('img-sec', this)">üñºÔ∏è Image Optimizer</div>
    <div class="nav-btn" onclick="showSection('pdf-merge-sec', this)">üìë PDF Merger</div>
    <div class="nav-btn" onclick="showSection('pdf-edit-sec', this)">‚úçÔ∏è PDF Editor</div>
    
    <div style="margin-top: auto; font-size: 0.8rem; color: #94a3b8; text-align: center;">
        <a href="privacy.html">Privacy</a> | <a href="contact.html">Contact</a>
    </div>
</div>

<div class="main-content">
    <div class="ad-slot">ADSENSE_TOP_BANNER</div>

    <div id="loan-sec" class="tool-section active">
        <div class="card">
            <h2>Universal Loan Calc</h2>
            <div class="goal-selector">
                <button class="g-btn active" onclick="setGoal('emi', this)">EMI</button>
                <button class="g-btn" onclick="setGoal('amount', this)">Principal</button>
                <button class="g-btn" onclick="setGoal('tenure', this)">Tenure</button>
            </div>
            <div id="grp-amt" class="input-group"><label>Loan Amount ($)</label><input type="number" id="v-amt" placeholder="e.g. 1000000"></div>
            <div class="input-group"><label>Interest Rate (% Annual)</label><input type="number" id="v-rate" step="0.01" placeholder="7.5"></div>
            <div id="grp-ten" class="input-group"><label>Tenure (Years)</label><input type="number" id="v-ten" placeholder="20"></div>
            <div id="grp-emi" class="input-group hidden"><label>Monthly Payment ($)</label><input type="number" id="v-emi" placeholder="5000"></div>
            <button class="action-btn" onclick="calculateLoan()">Analyze Loan</button>
            <div id="loan-res" class="hidden" style="margin-top:20px; background:var(--primary); color:white; padding:25px; border-radius:15px;">
                <small id="l-label">Monthly EMI</small><h1 id="l-main" style="color:var(--success);">$0.00</h1>
            </div>
        </div>
    </div>

    <div id="img-sec" class="tool-section">
        <div class="card">
            <h2>Image Compressor</h2>
            <div class="input-group">
                <label>Quality (0.1 to 1.0)</label>
                <input type="range" id="img-q" min="0.1" max="1.0" step="0.1" value="0.7">
            </div>
            <input type="file" id="img-in" accept="image/*">
            <button class="action-btn" style="margin-top:20px;" onclick="optimizeImage()">Compress & Download</button>
        </div>
    </div>

    <div id="pdf-merge-sec" class="tool-section">
        <div class="card">
            <h2>Merge Multiple PDFs</h2>
            <input type="file" id="pdf-merge-in" accept="application/pdf" multiple>
            <button class="action-btn btn-merge" style="margin-top:20px;" onclick="mergePDFs()">Combine PDFs</button>
        </div>
    </div>

    <div id="pdf-edit-sec" class="tool-section">
        <div class="card">
            <h2>PDF Text Editor</h2>
            <p style="font-size: 0.8rem; color: #64748b;">Upload a PDF to add text to the first page (useful for signatures/notes).</p>
            <div class="input-group">
                <label>1. Select PDF</label>
                <input type="file" id="pdf-edit-in" accept="application/pdf">
            </div>
            <div class="input-group">
                <label>2. Text to Add</label>
                <input type="text" id="pdf-text" placeholder="Type your text or name here">
            </div>
            <div class="input-group">
                <label>3. Position (X, Y)</label>
                <div style="display:flex; gap:10px;">
                    <input type="number" id="pdf-x" value="50">
                    <input type="number" id="pdf-y" value="50">
                </div>
            </div>
            <button class="action-btn" onclick="editPDF()">Apply Text & Download</button>
        </div>
    </div>

    <div class="ad-slot">ADSENSE_BOTTOM_BANNER</div>
</div>

<script>
    function showSection(id, btn) {
        document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // LOAN LOGIC
    let currentGoal = 'emi';
    function setGoal(goal, btn) {
        currentGoal = goal;
        document.querySelectorAll('.g-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('grp-amt').classList.toggle('hidden', goal === 'amount');
        document.getElementById('grp-ten').classList.toggle('hidden', goal === 'tenure');
        document.getElementById('grp-emi').classList.toggle('hidden', goal === 'emi');
    }

    function calculateLoan() {
        const amt = parseFloat(document.getElementById('v-amt').value);
        const rate = parseFloat(document.getElementById('v-rate').value) / 1200;
        const years = parseFloat(document.getElementById('v-ten').value);
        const emiIn = parseFloat(document.getElementById('v-emi').value);
        const fmt = (v) => '$' + v.toLocaleString('en-US', {maximumFractionDigits: 2});

        let main, label;
        if (currentGoal === 'emi') {
            let n = years * 12;
            let emi = (amt * rate * Math.pow(1 + rate, n)) / (Math.pow(1 + rate, n) - 1);
            main = fmt(emi); label = "Monthly EMI";
        } else if (currentGoal === 'amount') {
            let n = years * 12;
            let p = (emiIn * (Math.pow(1 + rate, n) - 1)) / (rate * Math.pow(1 + rate, n));
            main = fmt(p); label = "Max Principal";
        } else if (currentGoal === 'tenure') {
            let n = Math.log(emiIn / (emiIn - amt * rate)) / Math.log(1 + rate);
            main = (n / 12).toFixed(1) + " Years"; label = "Required Tenure";
        }
        document.getElementById('l-main').innerText = main;
        document.getElementById('l-label').innerText = label;
        document.getElementById('loan-res').classList.remove('hidden');
    }

    // IMAGE LOGIC
    function optimizeImage() {
        const file = document.getElementById('img-in').files[0];
        const q = parseFloat(document.getElementById('img-q').value);
        if (!file) return alert("Select image");
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = (e) => {
            const img = new Image();
            img.src = e.target.result;
            img.onload = () => {
                const canvas = document.createElement('canvas');
                canvas.width = img.width; canvas.height = img.height;
                canvas.getContext('2d').drawImage(img, 0, 0);
                const data = canvas.toDataURL('image/jpeg', q);
                const a = document.createElement('a'); a.href = data; a.download = "optimized.jpg"; a.click();
            };
        };
    }

    // PDF MERGE
    async function mergePDFs() {
        const files = document.getElementById('pdf-merge-in').files;
        if (files.length < 2) return alert("Select 2+ PDFs");
        const merged = await PDFLib.PDFDocument.create();
        for (const f of files) {
            const bytes = await f.arrayBuffer();
            const pdf = await PDFLib.PDFDocument.load(bytes);
            const pages = await merged.copyPages(pdf, pdf.getPageIndices());
            pages.forEach(p => merged.addPage(p));
        }
        const bytes = await merged.save();
        download(bytes, "merged.pdf", "application/pdf");
    }

    // PDF EDIT (ADD TEXT)
    async function editPDF() {
        const file = document.getElementById('pdf-edit-in').files[0];
        const text = document.getElementById('pdf-text').value;
        const x = parseInt(document.getElementById('pdf-x').value);
        const y = parseInt(document.getElementById('pdf-y').value);
        if (!file || !text) return alert("Select PDF and enter text");

        const bytes = await file.arrayBuffer();
        const pdfDoc = await PDFLib.PDFDocument.load(bytes);
        const pages = pdfDoc.getPages();
        const firstPage = pages[0];
        
        firstPage.drawText(text, { x: x, y: y, size: 20, color: PDFLib.rgb(0, 0, 0) });
        
        const editedBytes = await pdfDoc.save();
        download(editedBytes, "edited.pdf", "application/pdf");
    }

    function download(data, name, type) {
        const blob = new Blob([data], { type: type });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = name; a.click();
    }
</script>
</body>
</html>
