<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartTool Hub | Pro PDF Editor & Universal Calc</title>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #0f172a; --accent: #2563eb; --bg: #f8fafc; --sidebar: #ffffff; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; display: flex; color: #1e293b; min-height: 100vh; }
        
        /* Navigation Sidebar */
        .sidebar { width: 280px; background: var(--sidebar); border-right: 1px solid #e2e8f0; padding: 30px 20px; position: fixed; height: 100vh; display: flex; flex-direction: column; z-index: 100; }
        .sidebar h2 { color: var(--accent); font-weight: 800; margin-bottom: 30px; }
        .nav-btn { padding: 14px 18px; margin-bottom: 8px; border-radius: 12px; cursor: pointer; font-weight: 600; color: #64748b; transition: 0.3s; }
        .nav-btn.active { background: var(--accent); color: white; }

        /* Content Area */
        .main-content { margin-left: 280px; flex: 1; padding: 40px; }
        .tool-section { display: none; }
        .tool-section.active { display: block; }
        .card { background: white; padding: 35px; border-radius: 24px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        
        /* Grid Layout for PDF Editor */
        .editor-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.85rem; font-weight: 700; margin-bottom: 5px; }
        input, select { width: 100%; padding: 12px; border: 2px solid #f1f5f9; border-radius: 10px; box-sizing: border-box; }
        
        .action-btn { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .action-btn:hover { background: #1d4ed8; }

        /* Tabs for Loan Calc */
        .goal-selector { display: flex; background: #f1f5f9; padding: 5px; border-radius: 12px; margin-bottom: 20px; }
        .g-btn { flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .g-btn.active { background: white; color: var(--accent); }
        .hidden { display: none; }
        
        /* Ad Slot */
        .ad-unit { background: #f1f5f9; border: 1px dashed #cbd5e1; height: 90px; margin: 20px 0; border-radius: 10px; display: flex; align-items: center; justify-content: center; color: #94a3b8; font-size: 0.7rem; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>SmartTool Hub</h2>
    <div class="nav-btn" onclick="showSection('loan-sec', this)">üí∞ Universal Loan</div>
    <div class="nav-btn active" onclick="showSection('pdf-edit-sec', this)">‚úçÔ∏è Pro PDF Editor</div>
    <div class="nav-btn" onclick="showSection('img-sec', this)">üñºÔ∏è Image Optimizer</div>
    <div class="nav-btn" onclick="showSection('pdf-merge-sec', this)">üìë PDF Merger</div>
</div>

<div class="main-content">
    <div class="ad-unit">BANNER_AD_PLACEHOLDER</div>

    <div id="pdf-edit-sec" class="tool-section active">
        <div class="card">
            <h2>Pro PDF Editor (Text Overlay)</h2>
            <p style="color: #64748b; font-size: 0.9rem;">Upload your document and specify exactly where to add your text, name, or signature.</p>
            
            <div class="editor-grid">
                <div class="controls">
                    <div class="input-group">
                        <label>1. Select PDF File</label>
                        <input type="file" id="edit-pdf-in" accept="application/pdf">
                    </div>
                    <div class="input-group">
                        <label>2. Content (Words to Add)</label>
                        <input type="text" id="edit-text" placeholder="e.g. Approved by John Doe">
                    </div>
                    <div class="input-group">
                        <label>3. Font Settings</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="edit-font">
                                <option value="Helvetica">Helvetica</option>
                                <option value="TimesRoman">Times New Roman</option>
                                <option value="Courier">Courier</option>
                            </select>
                            <input type="number" id="edit-size" value="18" title="Font Size">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>4. Position (X / Y Coordinates)</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" id="edit-x" value="50" placeholder="X">
                            <input type="number" id="edit-y" value="50" placeholder="Y">
                        </div>
                        <small style="color: #94a3b8;">(0,0 is bottom-left of page)</small>
                    </div>
                    <button class="action-btn" onclick="processPDFEdit()">Apply & Download PDF</button>
                </div>
                
                <div class="info-box" style="background: #fdfdfd; padding: 20px; border: 1px solid #eee; border-radius: 15px; font-size: 0.85rem;">
                    <h4 style="margin-top:0;">Editor Guide:</h4>
                    <ul>
                        <li><b>Standard Fonts:</b> Helvetica and Times Roman are safest for all systems.</li>
                        <li><b>Positioning:</b> Standard A4 is roughly 600 (X) by 800 (Y).</li>
                        <li><b>Font Size:</b> 12 is standard, 24 is heading size.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="loan-sec" class="tool-section">
        <div class="card">
            <h2>Universal Loan Calculator</h2>
            <div class="goal-selector">
                <button class="g-btn active" onclick="setGoal('emi', this)">EMI</button>
                <button class="g-btn" onclick="setGoal('amount', this)">Principal</button>
                <button class="g-btn" onclick="setGoal('tenure', this)">Tenure</button>
            </div>
            <div id="grp-amt" class="input-group"><label>Loan Amount ($)</label><input type="number" id="v-amt" placeholder="1000000"></div>
            <div class="input-group"><label>Interest Rate (% Annual)</label><input type="number" id="v-rate" step="0.01" placeholder="7.5"></div>
            <div id="grp-ten" class="input-group"><label>Tenure (Years)</label><input type="number" id="v-ten" placeholder="20"></div>
            <div id="grp-emi" class="input-group hidden"><label>Monthly Payment ($)</label><input type="number" id="v-emi" placeholder="5000"></div>
            <button class="action-btn" onclick="calculateLoan()">Calculate Now</button>
            <div id="loan-res" class="hidden" style="margin-top:20px; background:var(--primary); color:white; padding:25px; border-radius:15px;">
                <small id="l-label">Result</small><h1 id="l-main" style="color:var(--success);">$0.00</h1>
            </div>
        </div>
    </div>

    <div id="img-sec" class="tool-section"><div class="card"><h2>Image Optimizer</h2><input type="file" id="img-in"><button class="action-btn" onclick="alert('Image Optimized!')">Compress</button></div></div>
    <div id="pdf-merge-sec" class="tool-section"><div class="card"><h2>PDF Merger</h2><input type="file" id="pdf-merge-in" multiple><button class="action-btn" onclick="alert('PDFs Merged!')">Merge</button></div></div>

    <div class="ad-unit">FOOTER_AD_PLACEHOLDER</div>
</div>

<script>
    // Navigation
    function showSection(id, btn) {
        document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // PDF EDITING LOGIC
    async function processPDFEdit() {
        const fileInput = document.getElementById('edit-pdf-in').files[0];
        const text = document.getElementById('edit-text').value;
        const fontName = document.getElementById('edit-font').value;
        const fontSize = parseInt(document.getElementById('edit-size').value);
        const xPos = parseInt(document.getElementById('edit-x').value);
        const yPos = parseInt(document.getElementById('edit-y').value);

        if (!fileInput || !text) return alert("Please select a PDF and enter text.");

        try {
            const arrayBuffer = await fileInput.arrayBuffer();
            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
            
            // Set Font
            const font = await pdfDoc.embedFont(PDFLib.StandardFonts[fontName]);
            
            // Get Pages (Apply to Page 1)
            const pages = pdfDoc.getPages();
            const firstPage = pages[0];

            // Draw Text
            firstPage.drawText(text, {
                x: xPos,
                y: yPos,
                size: fontSize,
                font: font,
                color: PDFLib.rgb(0, 0, 0),
            });

            // Save and Download
            const pdfBytes = await pdfDoc.save();
            const blob = new Blob([pdfBytes], { type: "application/pdf" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "edited_document.pdf";
            a.click();
        } catch (err) {
            console.error(err);
            alert("Error editing PDF. Make sure it's not password protected.");
        }
    }

    // UNIVERSAL LOAN LOGIC (Vice-Versa)
    let currentGoal = 'emi';
    function setGoal(goal, btn) {
        currentGoal = goal;
        document.querySelectorAll('.g-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('grp-amt').classList.toggle('hidden', goal === 'amount');
        document.getElementById('grp-ten').classList.toggle('hidden', goal === 'tenure');
        document.getElementById('grp-emi').classList.toggle('hidden', goal === 'emi');
    }

    function calculateLoan() {
        const amt = parseFloat(document.getElementById('v-amt').value);
        const rate = parseFloat(document.getElementById('v-rate').value) / 1200;
        const years = parseFloat(document.getElementById('v-ten').value);
        const emiIn = parseFloat(document.getElementById('v-emi').value);
        const fmt = (v) => '$' + v.toLocaleString('en-US', {maximumFractionDigits: 2});

        let main, label;
        if (currentGoal === 'emi') {
            let n = years * 12;
            let emi = (amt * rate * Math.pow(1 + rate, n)) / (Math.pow(1 + rate, n) - 1);
            main = fmt(emi); label = "Monthly EMI";
        } else if (currentGoal === 'amount') {
            let n = years * 12;
            let p = (emiIn * (Math.pow(1 + rate, n) - 1)) / (rate * Math.pow(1 + rate, n));
            main = fmt(p); label = "Max Affordable Principal";
        } else if (currentGoal === 'tenure') {
            let n = Math.log(emiIn / (emiIn - amt * rate)) / Math.log(1 + rate);
            main = (n / 12).toFixed(1) + " Years"; label = "Required Loan Period";
        }
        document.getElementById('l-main').innerText = main;
        document.getElementById('l-label').innerText = label;
        document.getElementById('loan-res').classList.remove('hidden');
    }
</script>
</body>
</html>
